FROM mcr.microsoft.com/powershell

RUN apt-get update
RUN apt-get install wget gnupg software-properties-common -y

RUN wget -O - https://apt.corretto.aws/corretto.key | apt-key add
RUN add-apt-repository 'deb https://apt.corretto.aws stable main'

RUN apt-get update; apt-get install -y java-1.8.0-amazon-corretto-jdk

WORKDIR /repo

COPY src ./src
COPY libs ./libs

RUN javac -classpath /repo/libs/log4j-api-2.16.0.jar:/repo/libs/log4j-core-2.16.0.jar /repo/src/Log4JExploit.java

ENTRYPOINT ["java", "-classpath", "/repo/libs/log4j-api-2.16.0.jar:/repo/libs/log4j-core-2.16.0.jar:/repo/src", "Log4JExploit"]